<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <link rel="stylesheet" href="css/reset.css">
</head>

<body>
  <canvas id="canvas"></canvas>
  <script src="js/draw.js"></script>
  <script src="js/lib/mock.js"></script>
  <script>
    var canvas = document.getElementById('canvas');
    var winWidth = window.innerWidth;
    var winHeight = window.innerHeight
    canvas.width = winWidth;
    canvas.height = winHeight;

    var ctx = canvas.getContext('2d');

    // circle();
    function ran(num) {
      return num ? Math.random() * num : Math.random();
    }


    ;
    (function (win) {

      function Circle() {
        if (!(this instanceof Circle)) {
          return new Circle();
        }
        this.x = ran(winWidth);
        this.y = ran(winHeight);
        this.r = Math.floor(ran(10));
        this.vx = ran(5);
        this.vy = ran(5);
        this.color = 'red';
      }
      Circle.prototype = {
        constructor: Circle,
        draw: function (ctx) {
          ctx.beginPath();
          ctx.arc(this.x, this.y, this.r, 0, 360);
          ctx.fillStyle = this.color;
          ctx.fill();
          ctx.closePath();
        },
        move: function (ctx) {
          // console.log(ctx);
          var canvasWidth = ctx.canvas.width;
          var canvasHeight = ctx.canvas.height;

          if (this.y > (canvasHeight - this.r) || (this.y < this.r)) {
            this.vy = -this.vy;
          }

          if (this.x > (canvasWidth - this.r) || (this.x < this.r)) {
            this.vx = -this.vx;
          }

          // if (this.r >= 30) {
          //   this.r -= 1;
          // }else if (this.r > 0 && this.r < 30) {
          //   this.r += 1;
          // }
          
          
          this.x += this.vx;
          this.y += this.vy;

          this.color = Mock.Random.color();
        }
      }
      win.Circle = Circle;

    }(window));

    var circles = [];

    for (var i = 0; i < 500; i++) {
      circles.push(Circle());
    }
    var len = circles.length;

    function draw() {
      ctx.clearRect(0, 0, winWidth, winHeight);
      for (var i = 0; i < len; i++) {
        var circle = circles[i];
        circle.move(ctx);
        circle.draw(ctx);
      }
      requestAnimationFrame(draw);
    }
    draw();

    console.log(circles);
    // Circle().draw(ctx);
    // requestAnimationFrame
  </script>
</body>

</html>